<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="John Blischak" />

<meta name="date" content="2019-09-26" />

<title>Data transformation with dplyr</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">wflow-r4ds</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/wflow-r4ds">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data transformation with dplyr</h1>
<h4 class="author">John Blischak</h4>
<h4 class="date">2019-09-26</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-09-26
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>wflow-r4ds/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.4.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20190925code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20190925)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20190925code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20190925)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomjdblischakwflowr4dstree3b94f62a2c1365b9b0d457973ecc62a7a0f0bbfbtargetblank3b94f62a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/jdblischak/wflow-r4ds/tree/3b94f62a2c1365b9b0d457973ecc62a7a0f0bbfb" target="_blank">3b94f62</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomjdblischakwflowr4dstree3b94f62a2c1365b9b0d457973ecc62a7a0f0bbfbtargetblank3b94f62a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jdblischak/wflow-r4ds/blob/3b94f62a2c1365b9b0d457973ecc62a7a0f0bbfb/analysis/03-dplyr.Rmd" target="_blank">3b94f62</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
<td>
R is not C! ^ is exponentiation, not ‘exclusive or’
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jdblischak/wflow-r4ds/332efa00414e2ba621cf48e1370f1673212be4f3/docs/03-dplyr.html" target="_blank">332efa0</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jdblischak/wflow-r4ds/blob/ace5f599a233a886fe2490c6c03ec3f762c1f5b5/analysis/03-dplyr.Rmd" target="_blank">ace5f59</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
<td>
more dplyr exercises
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jdblischak/wflow-r4ds/2eac6e611212448cb906602103f52615ec9d22ba/docs/03-dplyr.html" target="_blank">2eac6e6</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jdblischak/wflow-r4ds/blob/5f7de6bc8cf26693918ac7813e7fd3fc26303826/analysis/03-dplyr.Rmd" target="_blank">5f7de6b</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
<td>
Start chp 3 exercises on dplyr
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<ul>
<li><a href="https://r4ds.had.co.nz/transform.html">Book chapter</a></li>
<li><a href="https://github.com/hadley/r4ds/blob/master/transform.Rmd">Source</a></li>
</ul>
<div id="setup" class="section level2">
<h2>Setup</h2>
<pre class="r"><code>library(nycflights13)
library(tidyverse)</code></pre>
<pre><code>── Attaching packages ──────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>✔ ggplot2 3.2.1     ✔ purrr   0.3.2
✔ tibble  2.1.3     ✔ dplyr   0.8.3
✔ tidyr   1.0.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.4.0</code></pre>
<pre><code>── Conflicts ─────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div id="filter-rows-with-filter" class="section level2">
<h2>Filter rows with <code>filter()</code></h2>
<p>p. 49</p>
<blockquote>
<p>Find all flights that</p>
</blockquote>
<blockquote>
<p>Had an arrival delay of two or more hours</p>
</blockquote>
<pre class="r"><code>filter(flights, arr_delay &gt; 2 * 60)</code></pre>
<pre><code># A tibble: 10,034 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      811            630       101     1047
 2  2013     1     1      848           1835       853     1001
 3  2013     1     1      957            733       144     1056
 4  2013     1     1     1114            900       134     1447
 5  2013     1     1     1505           1310       115     1638
 6  2013     1     1     1525           1340       105     1831
 7  2013     1     1     1549           1445        64     1912
 8  2013     1     1     1558           1359       119     1718
 9  2013     1     1     1732           1630        62     2028
10  2013     1     1     1803           1620       103     2008
# … with 10,024 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Flew to Houston (<code>IAH</code> or <code>HOU</code>)</p>
</blockquote>
<pre class="r"><code>filter(flights, dest == &quot;IAH&quot; | dest == &quot;HOU&quot;)</code></pre>
<pre><code># A tibble: 9,313 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      517            515         2      830
 2  2013     1     1      533            529         4      850
 3  2013     1     1      623            627        -4      933
 4  2013     1     1      728            732        -4     1041
 5  2013     1     1      739            739         0     1104
 6  2013     1     1      908            908         0     1228
 7  2013     1     1     1028           1026         2     1350
 8  2013     1     1     1044           1045        -1     1352
 9  2013     1     1     1114            900       134     1447
10  2013     1     1     1205           1200         5     1503
# … with 9,303 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Were operated by United, American, or Delta</p>
</blockquote>
<pre class="r"><code>filter(flights, carrier %in% c(&quot;UA&quot;, &quot;AA&quot;, &quot;DL&quot;))</code></pre>
<pre><code># A tibble: 139,504 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      517            515         2      830
 2  2013     1     1      533            529         4      850
 3  2013     1     1      542            540         2      923
 4  2013     1     1      554            600        -6      812
 5  2013     1     1      554            558        -4      740
 6  2013     1     1      558            600        -2      753
 7  2013     1     1      558            600        -2      924
 8  2013     1     1      558            600        -2      923
 9  2013     1     1      559            600        -1      941
10  2013     1     1      559            600        -1      854
# … with 139,494 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Departed in summer (July, August, and September)</p>
</blockquote>
<pre class="r"><code>filter(flights, month %in% 7:9)</code></pre>
<pre><code># A tibble: 86,326 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     7     1        1           2029       212      236
 2  2013     7     1        2           2359         3      344
 3  2013     7     1       29           2245       104      151
 4  2013     7     1       43           2130       193      322
 5  2013     7     1       44           2150       174      300
 6  2013     7     1       46           2051       235      304
 7  2013     7     1       48           2001       287      308
 8  2013     7     1       58           2155       183      335
 9  2013     7     1      100           2146       194      327
10  2013     7     1      100           2245       135      337
# … with 86,316 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Arrived more than two hours late, but didn’t leave late</p>
</blockquote>
<pre class="r"><code>filter(flights, arr_delay &gt; 2 * 60, dep_delay &lt;=0)</code></pre>
<pre><code># A tibble: 29 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1    27     1419           1420        -1     1754
 2  2013    10     7     1350           1350         0     1736
 3  2013    10     7     1357           1359        -2     1858
 4  2013    10    16      657            700        -3     1258
 5  2013    11     1      658            700        -2     1329
 6  2013     3    18     1844           1847        -3       39
 7  2013     4    17     1635           1640        -5     2049
 8  2013     4    18      558            600        -2     1149
 9  2013     4    18      655            700        -5     1213
10  2013     5    22     1827           1830        -3     2217
# … with 19 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Were delayed by at least an hour, but made up over 30 minutes in flight</p>
</blockquote>
<pre class="r"><code>filter(flights, dep_delay &gt;= 60, arr_delay &lt; 30)</code></pre>
<pre><code># A tibble: 206 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     3     1850           1745        65     2148
 2  2013     1     3     1950           1845        65     2228
 3  2013     1     3     2015           1915        60     2135
 4  2013     1     6     1019            900        79     1558
 5  2013     1     7     1543           1430        73     1758
 6  2013     1    11     1020            920        60     1311
 7  2013     1    12     1706           1600        66     1949
 8  2013     1    12     1953           1845        68     2154
 9  2013     1    19     1456           1355        61     1636
10  2013     1    21     1531           1430        61     1843
# … with 196 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Departed between midnight and 6am (inclusive)</p>
</blockquote>
<pre class="r"><code>filter(flights, hour &lt;= 6)</code></pre>
<pre><code># A tibble: 27,905 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      517            515         2      830
 2  2013     1     1      533            529         4      850
 3  2013     1     1      542            540         2      923
 4  2013     1     1      544            545        -1     1004
 5  2013     1     1      554            600        -6      812
 6  2013     1     1      554            558        -4      740
 7  2013     1     1      555            600        -5      913
 8  2013     1     1      557            600        -3      709
 9  2013     1     1      557            600        -3      838
10  2013     1     1      558            600        -2      753
# … with 27,895 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Another useful dplyr filtering helper is <code>between()</code>. What does it do? Can you use it to simplify the code needed to answer the previous challenges?</p>
</blockquote>
<p><code>between()</code> selects numeric values between a minimum and maximum value (inclusive).</p>
<p>While I think <code>between()</code> is useful, I don’t find these examples very compelling.</p>
<pre class="r"><code>filter(flights, between(month, 7, 9))</code></pre>
<pre><code># A tibble: 86,326 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     7     1        1           2029       212      236
 2  2013     7     1        2           2359         3      344
 3  2013     7     1       29           2245       104      151
 4  2013     7     1       43           2130       193      322
 5  2013     7     1       44           2150       174      300
 6  2013     7     1       46           2051       235      304
 7  2013     7     1       48           2001       287      308
 8  2013     7     1       58           2155       183      335
 9  2013     7     1      100           2146       194      327
10  2013     7     1      100           2245       135      337
# … with 86,316 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code>filter(flights, between(hour, 0, 6))</code></pre>
<pre><code># A tibble: 27,905 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      517            515         2      830
 2  2013     1     1      533            529         4      850
 3  2013     1     1      542            540         2      923
 4  2013     1     1      544            545        -1     1004
 5  2013     1     1      554            600        -6      812
 6  2013     1     1      554            558        -4      740
 7  2013     1     1      555            600        -5      913
 8  2013     1     1      557            600        -3      709
 9  2013     1     1      557            600        -3      838
10  2013     1     1      558            600        -2      753
# … with 27,895 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>How many flights have a missing <code>dep_time</code>? What other variables are missing? What might these rows represent?</p>
</blockquote>
<pre class="r"><code>filter(flights, is.na(dep_time))</code></pre>
<pre><code># A tibble: 8,255 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1       NA           1630        NA       NA
 2  2013     1     1       NA           1935        NA       NA
 3  2013     1     1       NA           1500        NA       NA
 4  2013     1     1       NA            600        NA       NA
 5  2013     1     2       NA           1540        NA       NA
 6  2013     1     2       NA           1620        NA       NA
 7  2013     1     2       NA           1355        NA       NA
 8  2013     1     2       NA           1420        NA       NA
 9  2013     1     2       NA           1321        NA       NA
10  2013     1     2       NA           1545        NA       NA
# … with 8,245 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>I assume these are cancelled flights since all columns relating to departure and arrival times are missing.</p>
<blockquote>
<p>Why is <code>NA ^ 0</code> not missing? Why is <code>NA | TRUE</code> not missing? Why is <code>FALSE &amp; NA</code> not missing? Can you figure out the general rule? (<code>NA * 0</code> is a tricky counterexample!)</p>
</blockquote>
<pre class="r"><code>NA ^ 0 # same as NA ^ FALSE</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code>NA | TRUE</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>FALSE &amp; NA</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="r"><code>NA * 0</code></pre>
<pre><code>[1] NA</code></pre>
<p>I think the <code>NA | TRUE</code> and <code>FALSE &amp; NA</code> make sense. They are short-circuitng the logic. For an “or” statement, a <code>TRUE</code> on one of the sides is sufficient to render the entire statement true, regardless if the other data is missing. Vice verse for the “and”: a <code>FALSE</code> on either side is sufficient to make the entire statement false.</p>
<pre class="r"><code># have to be TRUE
NA | TRUE</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>TRUE | NA</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code># ambiguous
NA | FALSE</code></pre>
<pre><code>[1] NA</code></pre>
<pre class="r"><code>FALSE | NA</code></pre>
<pre><code>[1] NA</code></pre>
<pre class="r"><code># have to be TRUE
NA &amp; FALSE</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="r"><code>FALSE &amp; NA</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="r"><code># ambiguous
NA &amp; TRUE</code></pre>
<pre><code>[1] NA</code></pre>
<pre class="r"><code>TRUE &amp; NA</code></pre>
<pre><code>[1] NA</code></pre>
<p>The exponentiation logic also makes less sense to me. Any number raised to the 0th power is equal to 1. Furthermore, 1 raised to any power is also 1. From the docs for <code>?Arithmetic</code>:</p>
<blockquote>
<p>1 ^ y and y ^ 0 are 1, <em>always</em>.</p>
</blockquote>
<pre class="r"><code>NA ^ 0</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code>1 ^ NA</code></pre>
<pre><code>[1] 1</code></pre>
<p>Thus the general rule seems to be to allow <code>NA</code> if the missing value would not affect the outcome of the logic or arithmetic operation.</p>
<p>Thus I’m not sure why <code>NA * 0</code> returns <code>NA</code> when it should be <code>0</code> no matter the value. My only guess is that it may be related to the potential risk of division by zero.</p>
<pre class="r"><code>NA * 0</code></pre>
<pre><code>[1] NA</code></pre>
<pre class="r"><code>0 / NA</code></pre>
<pre><code>[1] NA</code></pre>
<pre class="r"><code>NA / NA * 0</code></pre>
<pre><code>[1] NA</code></pre>
</div>
<div id="arrange-rows-with-arrange" class="section level2">
<h2>Arrange rows with <code>arrange()</code></h2>
<p>p. 51</p>
<blockquote>
<p>How could you use <code>arrange()</code> to sort all missing values to the start? (Hint: use <code>is.na()</code>).</p>
</blockquote>
<pre class="r"><code>arrange(flights, desc(is.na(dep_time)))</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1       NA           1630        NA       NA
 2  2013     1     1       NA           1935        NA       NA
 3  2013     1     1       NA           1500        NA       NA
 4  2013     1     1       NA            600        NA       NA
 5  2013     1     2       NA           1540        NA       NA
 6  2013     1     2       NA           1620        NA       NA
 7  2013     1     2       NA           1355        NA       NA
 8  2013     1     2       NA           1420        NA       NA
 9  2013     1     2       NA           1321        NA       NA
10  2013     1     2       NA           1545        NA       NA
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Sort <code>flights</code> to find the most delayed flights. Find the flights that left earliest.</p>
</blockquote>
<pre class="r"><code>arrange(flights, desc(dep_delay))</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     9      641            900      1301     1242
 2  2013     6    15     1432           1935      1137     1607
 3  2013     1    10     1121           1635      1126     1239
 4  2013     9    20     1139           1845      1014     1457
 5  2013     7    22      845           1600      1005     1044
 6  2013     4    10     1100           1900       960     1342
 7  2013     3    17     2321            810       911      135
 8  2013     6    27      959           1900       899     1236
 9  2013     7    22     2257            759       898      121
10  2013    12     5      756           1700       896     1058
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code>arrange(flights, hour, minute) # left earliest in the AM</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     7    27       NA            106        NA       NA
 2  2013     1     2      458            500        -2      703
 3  2013     1     3      458            500        -2      650
 4  2013     1     4      456            500        -4      631
 5  2013     1     5      458            500        -2      640
 6  2013     1     6      458            500        -2      718
 7  2013     1     7      454            500        -6      637
 8  2013     1     8      454            500        -6      625
 9  2013     1     9      457            500        -3      647
10  2013     1    10      450            500       -10      634
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code>arrange(flights, dep_delay) # left earliest in relation to scheduled dep time</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013    12     7     2040           2123       -43       40
 2  2013     2     3     2022           2055       -33     2240
 3  2013    11    10     1408           1440       -32     1549
 4  2013     1    11     1900           1930       -30     2233
 5  2013     1    29     1703           1730       -27     1947
 6  2013     8     9      729            755       -26     1002
 7  2013    10    23     1907           1932       -25     2143
 8  2013     3    30     2030           2055       -25     2213
 9  2013     3     2     1431           1455       -24     1601
10  2013     5     5      934            958       -24     1225
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Sort <code>flights</code> to find the fastest flights.</p>
</blockquote>
<pre class="r"><code>arrange(flights, air_time)</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1    16     1355           1315        40     1442
 2  2013     4    13      537            527        10      622
 3  2013    12     6      922            851        31     1021
 4  2013     2     3     2153           2129        24     2247
 5  2013     2     5     1303           1315       -12     1342
 6  2013     2    12     2123           2130        -7     2211
 7  2013     3     2     1450           1500       -10     1547
 8  2013     3     8     2026           1935        51     2131
 9  2013     3    18     1456           1329        87     1533
10  2013     3    19     2226           2145        41     2305
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<blockquote>
<p>Which flights travelled the longest? Which travelled the shortest?</p>
</blockquote>
<pre class="r"><code>arrange(flights, desc(distance))</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     1     1      857            900        -3     1516
 2  2013     1     2      909            900         9     1525
 3  2013     1     3      914            900        14     1504
 4  2013     1     4      900            900         0     1516
 5  2013     1     5      858            900        -2     1519
 6  2013     1     6     1019            900        79     1558
 7  2013     1     7     1042            900       102     1620
 8  2013     1     8      901            900         1     1504
 9  2013     1     9      641            900      1301     1242
10  2013     1    10      859            900        -1     1449
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code>arrange(flights, distance)</code></pre>
<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1  2013     7    27       NA            106        NA       NA
 2  2013     1     3     2127           2129        -2     2222
 3  2013     1     4     1240           1200        40     1333
 4  2013     1     4     1829           1615       134     1937
 5  2013     1     4     2128           2129        -1     2218
 6  2013     1     5     1155           1200        -5     1241
 7  2013     1     6     2125           2129        -4     2224
 8  2013     1     7     2124           2129        -5     2212
 9  2013     1     8     2127           2130        -3     2304
10  2013     1     9     2126           2129        -3     2217
# … with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="select-columns-with-select" class="section level2">
<h2>Select columns with <code>select()</code></h2>
<p>p. 54</p>
<blockquote>
<p>Brainstorm as many ways as possible to select <code>dep_time</code>, <code>dep_delay</code>, <code>arr_time</code>, and <code>arr_delay</code> from <code>flights</code>.</p>
</blockquote>
<pre class="r"><code>select(flights, dep_time, dep_delay, arr_time, arr_delay)</code></pre>
<pre><code># A tibble: 336,776 x 4
   dep_time dep_delay arr_time arr_delay
      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1      517         2      830        11
 2      533         4      850        20
 3      542         2      923        33
 4      544        -1     1004       -18
 5      554        -6      812       -25
 6      554        -4      740        12
 7      555        -5      913        19
 8      557        -3      709       -14
 9      557        -3      838        -8
10      558        -2      753         8
# … with 336,766 more rows</code></pre>
<pre class="r"><code>select(flights, dep_time, dep_delay:arr_time, arr_delay)</code></pre>
<pre><code># A tibble: 336,776 x 4
   dep_time dep_delay arr_time arr_delay
      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1      517         2      830        11
 2      533         4      850        20
 3      542         2      923        33
 4      544        -1     1004       -18
 5      554        -6      812       -25
 6      554        -4      740        12
 7      555        -5      913        19
 8      557        -3      709       -14
 9      557        -3      838        -8
10      558        -2      753         8
# … with 336,766 more rows</code></pre>
<pre class="r"><code>select(flights, starts_with(&quot;dep&quot;), starts_with(&quot;arr&quot;))</code></pre>
<pre><code># A tibble: 336,776 x 4
   dep_time dep_delay arr_time arr_delay
      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1      517         2      830        11
 2      533         4      850        20
 3      542         2      923        33
 4      544        -1     1004       -18
 5      554        -6      812       -25
 6      554        -4      740        12
 7      555        -5      913        19
 8      557        -3      709       -14
 9      557        -3      838        -8
10      558        -2      753         8
# … with 336,766 more rows</code></pre>
<pre class="r"><code>select(flights, dep_time, arr_time, ends_with(&quot;delay&quot;))</code></pre>
<pre><code># A tibble: 336,776 x 4
   dep_time arr_time dep_delay arr_delay
      &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1      517      830         2        11
 2      533      850         4        20
 3      542      923         2        33
 4      544     1004        -1       -18
 5      554      812        -6       -25
 6      554      740        -4        12
 7      555      913        -5        19
 8      557      709        -3       -14
 9      557      838        -3        -8
10      558      753        -2         8
# … with 336,766 more rows</code></pre>
<blockquote>
<p>What happens if you include the name of a variable multiple times in a <code>select()</code> call?</p>
</blockquote>
<p>The column is added in the first place it is mentioned:</p>
<pre class="r"><code>select(flights, dep_time, dep_time)</code></pre>
<pre><code># A tibble: 336,776 x 1
   dep_time
      &lt;int&gt;
 1      517
 2      533
 3      542
 4      544
 5      554
 6      554
 7      555
 8      557
 9      557
10      558
# … with 336,766 more rows</code></pre>
<pre class="r"><code>select(flights, dep_time, arr_time, dep_time)</code></pre>
<pre><code># A tibble: 336,776 x 2
   dep_time arr_time
      &lt;int&gt;    &lt;int&gt;
 1      517      830
 2      533      850
 3      542      923
 4      544     1004
 5      554      812
 6      554      740
 7      555      913
 8      557      709
 9      557      838
10      558      753
# … with 336,766 more rows</code></pre>
<blockquote>
<p>What does the <code>one_of()</code> function do? Why might it be helpful in conjunction with this vector?</p>
</blockquote>
<p>From docs:</p>
<blockquote>
<p><code>one_of()</code>: Matches variable names in a character vector.</p>
</blockquote>
<p>Thus it serves a similar purpose as <code>%in%</code>. But <code>%in%</code> returns a logical vector (which could be used in <code>filter()</code>), whereas, <code>select()</code> accepts the integer position of the columns:</p>
<pre class="r"><code>vars &lt;- c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;dep_delay&quot;, &quot;arr_delay&quot;)
select(flights, one_of(vars))</code></pre>
<pre><code># A tibble: 336,776 x 5
    year month   day dep_delay arr_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  2013     1     1         2        11
 2  2013     1     1         4        20
 3  2013     1     1         2        33
 4  2013     1     1        -1       -18
 5  2013     1     1        -6       -25
 6  2013     1     1        -4        12
 7  2013     1     1        -5        19
 8  2013     1     1        -3       -14
 9  2013     1     1        -3        -8
10  2013     1     1        -2         8
# … with 336,766 more rows</code></pre>
<pre class="r"><code># This would be how to replace one_of()
select(flights, which(colnames(flights) %in% vars))</code></pre>
<pre><code># A tibble: 336,776 x 5
    year month   day dep_delay arr_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  2013     1     1         2        11
 2  2013     1     1         4        20
 3  2013     1     1         2        33
 4  2013     1     1        -1       -18
 5  2013     1     1        -6       -25
 6  2013     1     1        -4        12
 7  2013     1     1        -5        19
 8  2013     1     1        -3       -14
 9  2013     1     1        -3        -8
10  2013     1     1        -2         8
# … with 336,766 more rows</code></pre>
<blockquote>
<p>Does the result of running the following code surprise you? How do the select helpers deal with case by default? How can you change that default?</p>
</blockquote>
<pre class="r"><code>select(flights, contains(&quot;TIME&quot;))</code></pre>
<pre><code># A tibble: 336,776 x 6
   dep_time sched_dep_time arr_time sched_arr_time air_time
      &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;
 1      517            515      830            819      227
 2      533            529      850            830      227
 3      542            540      923            850      160
 4      544            545     1004           1022      183
 5      554            600      812            837      116
 6      554            558      740            728      150
 7      555            600      913            854      158
 8      557            600      709            723       53
 9      557            600      838            846      140
10      558            600      753            745      138
# … with 336,766 more rows, and 1 more variable: time_hour &lt;dttm&gt;</code></pre>
<p>The tidyselect helpers ignore case by default (<code>ignore.case = TRUE</code>):</p>
<pre class="r"><code>formals(contains)$ignore.case</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>select(flights, contains(&quot;TIME&quot;, ignore.case = FALSE))</code></pre>
<pre><code># A tibble: 336,776 x 0</code></pre>
</div>
<div id="add-new-variables-with-mutate" class="section level2">
<h2>Add new variables with <code>mutate()</code></h2>
<p>p. 58</p>
<blockquote>
<p>Currently <code>dep_time</code> and <code>sched_dep_time</code> are convenient to look at, but hard to compute with because they’re not really continuous numbers. Convert them to a more convenient representation of number of minutes since midnight.</p>
</blockquote>
<pre class="r"><code>select(flights, dep_time, sched_dep_time)</code></pre>
<pre><code># A tibble: 336,776 x 2
   dep_time sched_dep_time
      &lt;int&gt;          &lt;int&gt;
 1      517            515
 2      533            529
 3      542            540
 4      544            545
 5      554            600
 6      554            558
 7      555            600
 8      557            600
 9      557            600
10      558            600
# … with 336,766 more rows</code></pre>
<pre class="r"><code>transmute(flights, dep_time, sched_dep_time,
          dep_time_min = dep_time %/% 100 * 60 + dep_time %% 100,
          sched_dep_time_min = sched_dep_time %/% 100 * 60 + sched_dep_time %% 100)</code></pre>
<pre><code># A tibble: 336,776 x 4
   dep_time sched_dep_time dep_time_min sched_dep_time_min
      &lt;int&gt;          &lt;int&gt;        &lt;dbl&gt;              &lt;dbl&gt;
 1      517            515          317                315
 2      533            529          333                329
 3      542            540          342                340
 4      544            545          344                345
 5      554            600          354                360
 6      554            558          354                358
 7      555            600          355                360
 8      557            600          357                360
 9      557            600          357                360
10      558            600          358                360
# … with 336,766 more rows</code></pre>
<blockquote>
<p>Compare <code>air_time</code> with <code>arr_time - dep_time</code>. What do you expect to see? What do you see? What do you need to do to fix it?</p>
</blockquote>
<p>I expect them to be the same.</p>
<pre class="r"><code>transmute(flights, air_time, arr_time - dep_time)</code></pre>
<pre><code># A tibble: 336,776 x 2
   air_time `arr_time - dep_time`
      &lt;dbl&gt;                 &lt;int&gt;
 1      227                   313
 2      227                   317
 3      160                   381
 4      183                   460
 5      116                   258
 6      150                   186
 7      158                   358
 8       53                   152
 9      140                   281
10      138                   195
# … with 336,766 more rows</code></pre>
<p><code>arr_time - dep_time</code> is greater than <code>air_time</code></p>
<pre class="r"><code>transmute(flights, air_time, total = arr_time - dep_time, total - air_time)</code></pre>
<pre><code># A tibble: 336,776 x 3
   air_time total `total - air_time`
      &lt;dbl&gt; &lt;int&gt;              &lt;dbl&gt;
 1      227   313                 86
 2      227   317                 90
 3      160   381                221
 4      183   460                277
 5      116   258                142
 6      150   186                 36
 7      158   358                200
 8       53   152                 99
 9      140   281                141
10      138   195                 57
# … with 336,766 more rows</code></pre>
<p><code>air_time</code> is in minutes, but the delays are in HHMM format. I first need to convert the delays to minutes from midnight, as above. I am pretty sure the departure and arrival times are reported using the same timezone.</p>
<pre class="r"><code>minutes &lt;- transmute(flights,
                     dep_time,
                     dep_time_min = dep_time %/% 100 * 60 + dep_time %% 100,
                     arr_time,
                     arr_time_min = arr_time %/% 100 * 60 + arr_time %% 100,
                     air_time,
                     total = arr_time_min - dep_time_min,
                     concord = air_time == total)
minutes</code></pre>
<pre><code># A tibble: 336,776 x 7
   dep_time dep_time_min arr_time arr_time_min air_time total concord
      &lt;int&gt;        &lt;dbl&gt;    &lt;int&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;  
 1      517          317      830          510      227   193 FALSE  
 2      533          333      850          530      227   197 FALSE  
 3      542          342      923          563      160   221 FALSE  
 4      544          344     1004          604      183   260 FALSE  
 5      554          354      812          492      116   138 FALSE  
 6      554          354      740          460      150   106 FALSE  
 7      555          355      913          553      158   198 FALSE  
 8      557          357      709          429       53    72 FALSE  
 9      557          357      838          518      140   161 FALSE  
10      558          358      753          473      138   115 FALSE  
# … with 336,766 more rows</code></pre>
<p>I checked to see if <code>air_time</code> was computed from the scheduled departure and arrival times, but these didn’t match either.</p>
<pre class="r"><code>minutes &lt;- transmute(flights,
                     sched_dep_time,
                     sched_dep_time_min = sched_dep_time %/% 100 * 60 + sched_dep_time %% 100,
                     sched_arr_time,
                     sched_arr_time_min = sched_arr_time %/% 100 * 60 + sched_arr_time %% 100,
                     air_time,
                     total = sched_arr_time_min - sched_dep_time_min,
                     concord = air_time == total)
minutes</code></pre>
<pre><code># A tibble: 336,776 x 7
   sched_dep_time sched_dep_time_… sched_arr_time sched_arr_time_… air_time
            &lt;int&gt;            &lt;dbl&gt;          &lt;int&gt;            &lt;dbl&gt;    &lt;dbl&gt;
 1            515              315            819              499      227
 2            529              329            830              510      227
 3            540              340            850              530      160
 4            545              345           1022              622      183
 5            600              360            837              517      116
 6            558              358            728              448      150
 7            600              360            854              534      158
 8            600              360            723              443       53
 9            600              360            846              526      140
10            600              360            745              465      138
# … with 336,766 more rows, and 2 more variables: total &lt;dbl&gt;,
#   concord &lt;lgl&gt;</code></pre>
<p>Doing some research online (<a href="https://jrnold.github.io/r4ds-exercise-solutions/transform.html#add-new-variables-with-mutate">source</a>), it appears that these won’t match up since <code>air_time</code> does not include taxi-ing.</p>
<blockquote>
<p>Compare <code>dep_time</code>, <code>sched_dep_time</code>, and <code>dep_delay</code>. How would you expect those three numbers to be related?</p>
</blockquote>
<pre class="r"><code>transmute(flights, dep_time, sched_dep_time, dep_delay)</code></pre>
<pre><code># A tibble: 336,776 x 3
   dep_time sched_dep_time dep_delay
      &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;
 1      517            515         2
 2      533            529         4
 3      542            540         2
 4      544            545        -1
 5      554            600        -6
 6      554            558        -4
 7      555            600        -5
 8      557            600        -3
 9      557            600        -3
10      558            600        -2
# … with 336,766 more rows</code></pre>
<p>I expect <code>dep_delay</code> to be the number of minutes between <code>dep_time</code> and <code>sched_dep_time</code>.</p>
<pre class="r"><code>transmute(flights, dep_time, sched_dep_time, dep_delay,
          dep_time_min = dep_time %/% 100 * 60 + dep_time %% 100,
          sched_dep_time_min = sched_dep_time %/% 100 * 60 + sched_dep_time %% 100,
          expected_delay = dep_time_min - sched_dep_time_min,
          concond = expected_delay == dep_delay)</code></pre>
<pre><code># A tibble: 336,776 x 7
   dep_time sched_dep_time dep_delay dep_time_min sched_dep_time_…
      &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;
 1      517            515         2          317              315
 2      533            529         4          333              329
 3      542            540         2          342              340
 4      544            545        -1          344              345
 5      554            600        -6          354              360
 6      554            558        -4          354              358
 7      555            600        -5          355              360
 8      557            600        -3          357              360
 9      557            600        -3          357              360
10      558            600        -2          358              360
# … with 336,766 more rows, and 2 more variables: expected_delay &lt;dbl&gt;,
#   concond &lt;lgl&gt;</code></pre>
<blockquote>
<p>Find the 10 most delayed flights using a ranking function. How do you want to handle ties? Carefully read the documentation for <code>min_rank()</code>.</p>
</blockquote>
<p>Use <code>desc()</code> with <code>min_rank()</code> so that the most delayed flight is ranked first.</p>
<pre class="r"><code>delayed &lt;- transmute(flights, carrier, flight, dep_delay, rank = min_rank(desc(dep_delay)))
arrange(delayed, rank)</code></pre>
<pre><code># A tibble: 336,776 x 4
   carrier flight dep_delay  rank
   &lt;chr&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;
 1 HA          51      1301     1
 2 MQ        3535      1137     2
 3 MQ        3695      1126     3
 4 AA         177      1014     4
 5 MQ        3075      1005     5
 6 DL        2391       960     6
 7 DL        2119       911     7
 8 DL        2007       899     8
 9 DL        2047       898     9
10 AA         172       896    10
# … with 336,766 more rows</code></pre>
<p>The <code>NA</code>’s are left as is:</p>
<pre class="r"><code>sum(is.na(delayed$dep_delay))</code></pre>
<pre><code>[1] 8255</code></pre>
<pre class="r"><code>sum(is.na(delayed$rank))</code></pre>
<pre><code>[1] 8255</code></pre>
<blockquote>
<p>What does <code>1:3 + 1:10</code> return? Why?</p>
</blockquote>
<pre class="r"><code>1:3 + 1:10</code></pre>
<pre><code>Warning in 1:3 + 1:10: longer object length is not a multiple of shorter
object length</code></pre>
<pre><code> [1]  2  4  6  5  7  9  8 10 12 11</code></pre>
<p>The <code>1:3</code> is recycled. Thus it gets used 3 times, and then just the final <code>1</code>. Thus it is equivalent to the following:</p>
<pre class="r"><code>c(1:3 + 1:3, 1:3 + 4:6, 1:3 + 7:9, 1 + 10)</code></pre>
<pre><code> [1]  2  4  6  5  7  9  8 10 12 11</code></pre>
<blockquote>
<p>What trigonometric functions does R provide?</p>
</blockquote>
<pre class="r"><code>?Trig</code></pre>
<pre><code>cos(x)
sin(x)
tan(x)

acos(x)
asin(x)
atan(x)
atan2(y, x)

cospi(x)
sinpi(x)
tanpi(x)</code></pre>
</div>
<div id="group-summaries-with-summarize" class="section level2">
<h2>Group summaries with <code>summarize()</code></h2>
<p>p. 72</p>
<blockquote>
<p>Brainstorm at least 5 different ways to assess the typical delay characteristics of a group of flights. Consider the following scenarios:</p>
</blockquote>
<pre><code>* A flight is 15 minutes early 50% of the time, and 15 minutes late 50% of 
  the time.
  
* A flight is always 10 minutes late.

* A flight is 30 minutes early 50% of the time, and 30 minutes late 50% of 
  the time.
  
* 99% of the time a flight is on time. 1% of the time it&#39;s 2 hours late.

Which is more important: arrival delay or departure delay?</code></pre>
<blockquote>
<p>Come up with another approach that will give you the same output as <code>not_cancelled %&gt;% count(dest)</code> and <code>not_cancelled %&gt;% count(tailnum, wt = distance)</code> (without using <code>count()</code>).</p>
</blockquote>
<pre class="r"><code>not_cancelled &lt;- flights %&gt;% 
  filter(!is.na(dep_delay), !is.na(arr_delay))
not_cancelled %&gt;% count(dest)</code></pre>
<pre><code># A tibble: 104 x 2
   dest      n
   &lt;chr&gt; &lt;int&gt;
 1 ABQ     254
 2 ACK     264
 3 ALB     418
 4 ANC       8
 5 ATL   16837
 6 AUS    2411
 7 AVL     261
 8 BDL     412
 9 BGR     358
10 BHM     269
# … with 94 more rows</code></pre>
<pre class="r"><code>not_cancelled %&gt;%
  group_by(dest) %&gt;%
  summarize(n = n())</code></pre>
<pre><code># A tibble: 104 x 2
   dest      n
   &lt;chr&gt; &lt;int&gt;
 1 ABQ     254
 2 ACK     264
 3 ALB     418
 4 ANC       8
 5 ATL   16837
 6 AUS    2411
 7 AVL     261
 8 BDL     412
 9 BGR     358
10 BHM     269
# … with 94 more rows</code></pre>
<pre class="r"><code>not_cancelled %&gt;% count(tailnum, wt = distance)</code></pre>
<pre><code># A tibble: 4,037 x 2
   tailnum      n
   &lt;chr&gt;    &lt;dbl&gt;
 1 D942DN    3418
 2 N0EGMQ  239143
 3 N10156  109664
 4 N102UW   25722
 5 N103US   24619
 6 N104UW   24616
 7 N10575  139903
 8 N105UW   23618
 9 N107US   21677
10 N108UW   32070
# … with 4,027 more rows</code></pre>
<pre class="r"><code>not_cancelled %&gt;%
  group_by(tailnum) %&gt;%
  summarize(n = sum(distance))</code></pre>
<pre><code># A tibble: 4,037 x 2
   tailnum      n
   &lt;chr&gt;    &lt;dbl&gt;
 1 D942DN    3418
 2 N0EGMQ  239143
 3 N10156  109664
 4 N102UW   25722
 5 N103US   24619
 6 N104UW   24616
 7 N10575  139903
 8 N105UW   23618
 9 N107US   21677
10 N108UW   32070
# … with 4,027 more rows</code></pre>
<blockquote>
<p>Our definition of cancelled flights (<code>is.na(dep_delay) | is.na(arr_delay)</code> ) is slightly suboptimal. Why? Which is the most important column?</p>
</blockquote>
<p>I think <code>arr_delay</code> is more important. If a flight takes off on time, but lands at a different airport, that’s a big issue.</p>
<p>There are 1,175 flights that have a <code>dep_delay</code> but not a <code>arr_delay</code>.</p>
<pre class="r"><code>sum(is.na(flights$dep_delay) | is.na(flights$arr_delay))</code></pre>
<pre><code>[1] 9430</code></pre>
<pre class="r"><code>sum(is.na(flights$dep_delay))</code></pre>
<pre><code>[1] 8255</code></pre>
<pre class="r"><code>sum(is.na(flights$arr_delay))</code></pre>
<pre><code>[1] 9430</code></pre>
<pre class="r"><code>sum(xor(is.na(flights$dep_delay), is.na(flights$arr_delay)))</code></pre>
<pre><code>[1] 1175</code></pre>
<pre class="r"><code>sum(is.na(flights$dep_delay) &amp; !is.na(flights$arr_delay))</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>sum(!is.na(flights$dep_delay) &amp; is.na(flights$arr_delay))</code></pre>
<pre><code>[1] 1175</code></pre>
<p>Thus I guess a more strict definintion of “cancelled” would be <code>is.na(dep_delay)</code> and the few cases where the plane departs but doesn’t arrive could be classified as “no arrivals” (presumably this includes redirections and crashes).</p>
<blockquote>
<p>Look at the number of cancelled flights per day. Is there a pattern? Is the proportion of cancelled flights related to the average delay?</p>
</blockquote>
<pre class="r"><code>flights %&gt;%
  mutate(cancelled = is.na(dep_delay)) %&gt;%
  group_by(year, month, day) %&gt;%
  summarize(n = n(),
            prop_canc = sum(cancelled) / n,
            avg_delay = mean(dep_delay, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = avg_delay, y = prop_canc)) +
  geom_point(alpha = 0.25) +
  geom_smooth()</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/03-dplyr.Rmd/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-39-1">
Past versions of unnamed-chunk-39-1.png
</button>
</p>
<div id="fig-unnamed-chunk-39-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jdblischak/wflow-r4ds/blob/332efa00414e2ba621cf48e1370f1673212be4f3/docs/figure/03-dplyr.Rmd/unnamed-chunk-39-1.png" target="_blank">332efa0</a>
</td>
<td>
John Blischak
</td>
<td>
2019-09-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There is a slight pattern, but it’s mostly driven by the days where the average delay is greater than 10 minutes.</p>
<blockquote>
<p>Which carrier has the worst delays? Challenge: can you disentangle the effects of bad airports vs. bad carriers? Why/why not? (Hint: think about <code>flights %&gt;% group_by(carrier, dest) %&gt;% summarise(n())</code>)</p>
</blockquote>
<pre class="r"><code>flights %&gt;%
  group_by(carrier) %&gt;%
  summarize(mean_delay = mean(arr_delay, na.rm = TRUE)) %&gt;%
  arrange(desc(mean_delay))</code></pre>
<pre><code># A tibble: 16 x 2
   carrier mean_delay
   &lt;chr&gt;        &lt;dbl&gt;
 1 F9          21.9  
 2 FL          20.1  
 3 EV          15.8  
 4 YV          15.6  
 5 OO          11.9  
 6 MQ          10.8  
 7 WN           9.65 
 8 B6           9.46 
 9 9E           7.38 
10 UA           3.56 
11 US           2.13 
12 VX           1.76 
13 DL           1.64 
14 AA           0.364
15 HA          -6.92 
16 AS          -9.93 </code></pre>
<pre class="r"><code>flights %&gt;% group_by(carrier, dest) %&gt;% summarise(n())</code></pre>
<pre><code># A tibble: 314 x 3
# Groups:   carrier [16]
   carrier dest  `n()`
   &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;
 1 9E      ATL      59
 2 9E      AUS       2
 3 9E      AVL      10
 4 9E      BGR       1
 5 9E      BNA     474
 6 9E      BOS     914
 7 9E      BTV       2
 8 9E      BUF     833
 9 9E      BWI     856
10 9E      CAE       3
# … with 304 more rows</code></pre>
<blockquote>
<p>What does the <code>sort</code> argument to <code>count()</code> do. When might you use it?</p>
</blockquote>
<p>Sorts by value of <code>n</code>. Can be used instead of piping to <code>arrange()</code>.</p>
</div>
<div id="group-mutates-and-filters" class="section level2">
<h2>Group mutates (and filters)</h2>
<p>p. 75</p>
<blockquote>
<p>Refer back to the lists of useful mutate and filtering functions. Describe how each operation changes when you combine it with grouping.</p>
</blockquote>
<blockquote>
<p>Which plane (<code>tailnum</code>) has the worst on-time record?</p>
</blockquote>
<blockquote>
<p>What time of day should you fly if you want to avoid delays as much as possible?</p>
</blockquote>
<blockquote>
<p>For each destination, compute the total minutes of delay. For each flight, compute the proportion of the total delay for its destination.</p>
</blockquote>
<blockquote>
<p>Delays are typically temporally correlated: even once the problem that caused the initial delay has been resolved, later flights are delayed to allow earlier flights to leave. Using <code>lag()</code>, explore how the delay of a flight is related to the delay of the immediately preceding flight.</p>
</blockquote>
<blockquote>
<p>Look at each destination. Can you find flights that are suspiciously fast? (i.e. flights that represent a potential data entry error). Compute the air time a flight relative to the shortest flight to that destination. Which flights were most delayed in the air?</p>
</blockquote>
<blockquote>
<p>Find all destinations that are flown by at least two carriers. Use that information to rank the carriers.</p>
</blockquote>
<blockquote>
<p>For each plane, count the number of flights before the first delay of greater than 1 hour.</p>
</blockquote>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.4.0      stringr_1.4.0      dplyr_0.8.3       
 [4] purrr_0.3.2        readr_1.3.1        tidyr_1.0.0       
 [7] tibble_2.1.3       ggplot2_3.2.1      tidyverse_1.2.1   
[10] nycflights13_1.0.1

loaded via a namespace (and not attached):
 [1] tidyselect_0.2.5 xfun_0.9         haven_2.1.1      lattice_0.20-38 
 [5] colorspace_1.4-1 vctrs_0.2.0      generics_0.0.2   htmltools_0.3.6 
 [9] yaml_2.2.0       utf8_1.1.4       rlang_0.4.0      pillar_1.4.2    
[13] glue_1.3.1       withr_2.1.2      modelr_0.1.5     readxl_1.3.1    
[17] lifecycle_0.1.0  munsell_0.5.0    gtable_0.3.0     workflowr_1.4.0 
[21] cellranger_1.1.0 rvest_0.3.4      evaluate_0.14    labeling_0.3    
[25] knitr_1.25       fansi_0.4.0      broom_0.5.2      Rcpp_1.0.2      
[29] backports_1.1.4  scales_1.0.0     jsonlite_1.6     fs_1.3.1        
[33] hms_0.5.1        digest_0.6.21    stringi_1.4.3    grid_3.6.1      
[37] rprojroot_1.2    cli_1.1.0        tools_3.6.1      magrittr_1.5    
[41] lazyeval_0.2.2   crayon_1.3.4     whisker_0.4      pkgconfig_2.0.2 
[45] zeallot_0.1.0    xml2_1.2.2       lubridate_1.7.4  assertthat_0.2.1
[49] rmarkdown_1.15   httr_1.4.1       rstudioapi_0.10  R6_2.4.0        
[53] nlme_3.1-141     git2r_0.26.1     compiler_3.6.1  </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
